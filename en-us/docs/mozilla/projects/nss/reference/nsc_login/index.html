<h1>NSC_Login</h1><h3 id="name"><a href="#name" title="Permalink to  Name "> Name </a></h3><div><p><code>NSC_Login()</code> - log a user into a token.
</p></div><h3 id="syntax"><a href="#syntax" title="Permalink to  Syntax "> Syntax </a></h3><div><pre class="eval notranslate"><a href="/en-US/CK_RV" data-flaw="link1">CK_RV</a> NSC_Login(
  <a href="/en-US/CK_SESSION_HANDLE" data-flaw="link2">CK_SESSION_HANDLE</a> hSession,
  <a href="/en-US/CK_USER_TYPE" data-flaw="link3">CK_USER_TYPE</a> userType,
  <a href="/en-US/CK_CHAR_PTR" data-flaw="link4">CK_CHAR_PTR</a> pPin,
  <a href="/en-US/CK_ULONG" data-flaw="link5">CK_ULONG</a> ulPinLen
);
</pre></div><h3 id="parameters"><a href="#parameters" title="Permalink to  Parameters "> Parameters </a></h3><div><p><code>NSC_Login()</code> takes four parameters:
</p>
<dl><dt><code>hSession</code>
</dt><dd>[in] a session handle
</dd><dt><code>userType</code>
</dt><dd>[in] the user type (<code>CKU_SO</code> or <code>CKU_USER</code>)
</dd><dt><code>pPin</code>
</dt><dd>[in] a pointer that points to the user's PIN
</dd><dt><code>ulPinLen</code>
</dt><dd>[in] the length of the PIN
</dd></dl></div><h3 id="description"><a href="#description" title="Permalink to  Description "> Description </a></h3><div><p><code>NSC_Login()</code> logs a user into a token.
</p><p>The Security Officer (<code>CKU_SO</code>) only logs in to initialize the normal user's PIN. The SO PIN is the empty string. The NSS cryptographic module doesn't allow the SO to log in if the normal user's PIN is already initialized.
</p></div><h3 id="return_value"><a href="#return_value" title="Permalink to  Return value "> Return value </a></h3><div><p><code>NSC_Login()</code> returns the following return codes.
</p>
<ul><li> <code>CKR_OK</code>: the user logged in successfully.
</li><li> <code>CKR_DEVICE_ERROR</code>: the token is in the Error state.
</li><li> <code>CKR_HOST_MEMORY</code>: memory allocation failed.
</li><li> <code>CKR_PIN_INCORRECT</code>: the PIN is incorrect.
</li><li> <code>CKR_PIN_LEN_RANGE</code>: the PIN is too long (<code>ulPinLen</code> is greater than 255).<div class="note notecard">The function should return <code>CKR_PIN_INCORRECT</code> in this case.</div>
</li><li> <code>CKR_SESSION_HANDLE_INVALID</code>: the session handle is invalid.
</li><li> <code>CKR_USER_ALREADY_LOGGED_IN</code>: the user is already logged in.
</li><li> <code>CKR_USER_TYPE_INVALID</code>
<ul><li> The token can't authenticate the user because there is no key database or the user's password isn't initialized.
</li><li> <code>userType</code> is <code>CKU_SO</code> and the normal user's PIN is already initialized.
</li></ul>
</li></ul></div><h3 id="see_also"><a href="#see_also" title="Permalink to  See also "> See also </a></h3><div><ul><li> <a href="/en-US/docs/Mozilla/Projects/NSS/Reference/FC_Login">FC_Login</a>
</li></ul></div>