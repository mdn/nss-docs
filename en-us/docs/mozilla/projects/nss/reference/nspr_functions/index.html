<!DOCTYPE html><html><head><meta charset="utf-8"><title>NSPR functions - Mozilla | MDN</title></head><body><main><article class="main-page-content" lang="en-US"><h1>NSPR functions</h1><div><p><a class="external" href="https://www.mozilla.org/projects/nspr/" title="http://www.mozilla.org/projects/nspr/" rel=" noopener">NSPR</a> is a platform abstraction library that provides a cross-platform API to common OS services.&nbsp; NSS uses NSPR internally as the porting layer.&nbsp; However, a small number of NSPR functions are required for using the certificate verification and SSL functions in NSS.&nbsp; These NSPR functions are listed in this section.</p></div><h3 id="nspr_initialization_and_shutdown"><a href="#nspr_initialization_and_shutdown" title="Permalink to NSPR initialization and shutdown">NSPR initialization and shutdown</a></h3><div><p>NSPR is automatically initialized by the first NSPR function called by the application.&nbsp; Call <a class="internal" href="/en-US/PR_Cleanup" data-flaw="link1"><code>PR_Cleanup</code></a> to shut down NSPR and clean up its resources.<a class="internal" href="/en-US/PR_Init" data-flaw="link2"><br>
</a></p>
<ul> <li><a class="internal" href="/en-US/PR_Cleanup" data-flaw="link3">PR_Cleanup</a></li>
</ul></div><h3 id="error_reporting"><a href="#error_reporting" title="Permalink to Error reporting">Error reporting</a></h3><div><p>NSS uses NSPR's thread-specific error code to report errors.&nbsp; Call <a class="internal" href="/en-US/PR_GetError" data-flaw="link4"><code>PR_GetError</code></a> to get the error code of the last failed NSS or NSPR function.&nbsp; Call <a class="internal" href="/en-US/PR_SetError" data-flaw="link5"><code>PR_SetError</code></a> to set the error code, which can be retrieved with <code>PR_GetError</code> later.</p>
<p>The NSS functions <code>PORT_GetError</code> and <code>PORT_SetError</code> are simply wrappers of <code>PR_GetError</code> and <code>PR_SetError</code>.</p>
<ul> <li><a class="internal" href="/en-US/PR_GetError" data-flaw="link6">PR_GetError</a></li> <li><a class="internal" href="/en-US/PR_SetError" data-flaw="link7">PR_SetError</a></li>
</ul></div><h3 id="calendar_time"><a href="#calendar_time" title="Permalink to Calendar time">Calendar time</a></h3><div><p>NSS certificate verification functions take a <code>PRTime</code> parameter that specifies the time instant at which the validity of the certificate should verified.&nbsp; The NSPR function <a class="internal" href="/en-US/PR_Now" data-flaw="link8"><code>PR_Now</code></a> returns the current time in <code>PRTime</code>.</p>
<ul> <li><a class="internal" href="/en-US/PR_Now" data-flaw="link9">PR_Now</a></li>
</ul></div><h3 id="interval_time"><a href="#interval_time" title="Permalink to Interval time">Interval time</a></h3><div><p>The NSPR socket I/O functions <a class="internal" href="/en-US/PR_Recv" data-flaw="link10"><code>PR_Recv</code></a> and <a class="internal" href="/en-US/PR_Send" data-flaw="link11"><code>PR_Send</code></a> (used by the NSS SSL functions) take a <code>PRIntervalTime</code> timeout parameter.&nbsp; <code>PRIntervalTime</code> has an abstract, platform-dependent time unit.&nbsp; Call <a class="internal" href="/en-US/PR_SecondsToInterval" data-flaw="link12"><code>PR_SecondsToInterval</code></a> or <code><a class="internal" href="/en-US/PR_MillisecondsToInterval" data-flaw="link13">PR_MillisecondsToInterval</a></code> to convert a time interval in seconds or milliseconds to <code>PRIntervalTime</code>.</p>
<ul> <li><a class="internal" href="/en-US/PR_SecondsToInterval" data-flaw="link14">PR_SecondsToInterval</a></li> <li><a class="internal" href="/en-US/PR_MillisecondsToInterval" data-flaw="link15">PR_MillisecondsToInterval</a></li>
</ul></div><h3 id="nspr_io_layering"><a href="#nspr_io_layering" title="Permalink to NSPR I/O layering">NSPR I/O layering</a></h3><div><p>NSPR file descriptors can be layered, corresponding to the layers in the network stack.&nbsp; The SSL library in NSS implements the SSL protocol as an NSPR I/O layer, which sits on top of another NSPR I/O layer that represents TCP.</p>
<p>You can implement an NSPR I/O layer that wraps your own TCP socket code.&nbsp; The following NSPR functions allow you to create your own NSPR I/O layer and manipulate it.</p>
<ul> <li><a class="internal" href="/en-US/PR_GetUniqueIdentity" data-flaw="link16">PR_GetUniqueIdentity</a></li> <li><a class="internal" href="/en-US/PR_CreateIOLayerStub" data-flaw="link17">PR_CreateIOLayerStub</a></li> <li><a class="internal" href="/en-US/PR_GetDefaultIOMethods" data-flaw="link18">PR_GetDefaultIOMethods</a></li> <li><a class="internal" href="/en-US/PR_GetIdentitiesLayer" data-flaw="link19">PR_GetIdentitiesLayer</a></li> <li><a class="internal" href="/en-US/PR_GetLayersIdentity" data-flaw="link20">PR_GetLayersIdentity</a></li> <li><a class="internal" href="/en-US/PR_PushIOLayer" data-flaw="link21">PR_PushIOLayer</a></li> <li><a class="internal" href="/en-US/PR_PopIOLayer" data-flaw="link22">PR_PopIOLayer</a></li>
</ul></div><h3 id="wrapping_a_native_file_descriptor"><a href="#wrapping_a_native_file_descriptor" title="Permalink to Wrapping a native file descriptor">Wrapping a native file descriptor</a></h3><div><p>If your current TCP socket code uses the standard BSD socket API, a lighter-weight method than creating your own NSPR I/O layer is to simply import a native file descriptor into NSPR.&nbsp; This method is convenient and works for most applications.</p>
<ul> <li><a class="internal" href="/en-US/PR_ImportTCPSocket" data-flaw="link23">PR_ImportTCPSocket</a></li>
</ul></div><h3 id="socket_io_functions"><a href="#socket_io_functions" title="Permalink to Socket I/O functions">Socket I/O functions</a></h3><div><p>As mentioned above, the SSL library in NSS implements the SSL protocol as an NSPR I/O layer.&nbsp; Users call NSPR socket I/O functions to read from, write to, and shut down an SSL connection, and to close an NSPR file descriptor.</p>
<ul> <li><a class="internal" href="/en-US/PR_Read" data-flaw="link24">PR_Read</a></li> <li><a class="internal" href="/en-US/PR_Write" data-flaw="link25">PR_Write</a></li> <li><a class="internal" href="/en-US/PR_Recv" data-flaw="link26">PR_Recv</a></li> <li><a class="internal" href="/en-US/PR_Send" data-flaw="link27">PR_Send</a></li> <li><a class="internal" href="/en-US/PR_GetSocketOption" data-flaw="link28">PR_GetSocketOption</a></li> <li><a class="internal" href="/en-US/PR_SetSocketOption" data-flaw="link29">PR_SetSocketOption</a></li> <li><a class="internal" href="/en-US/PR_Shutdown" data-flaw="link30">PR_Shutdown</a></li> <li><a class="internal" href="/en-US/PR_Close" data-flaw="link31">PR_Close</a></li>
</ul></div></article><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h4>Found a problem with this page?</h4><ul><li><a href="https://github.com/mdn/content/blob/main/files/en-us/mozilla/projects/nss/reference/nspr_functions/index.html" title="Folder: en-us/mozilla/projects/nss/reference/nspr_functions (Opens in a new tab)" target="_blank" rel="noopener noreferrer">Source on <b>GitHub</b></a></li><li><a href="https://github.com/mdn/content/issues/new?body=MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FMozilla%2FProjects%2FNSS%2FReference%2FNSPR_functions%0A%0A%23%23%23%23+What+information+was+incorrect%2C+unhelpful%2C+or+incomplete%3F%0A%0A%0A%23%23%23%23+Specific+section+or+headline%3F%0A%0A%0A%23%23%23%23+What+did+you+expect+to+see%3F%0A%0A%0A%23%23%23%23+Did+you+test+this%3F+If+so%2C+how%3F%0A%0A%0A%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EMDN+Content+page+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fmozilla%2Fprojects%2Fnss%2Freference%2Fnspr_functions%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FMozilla%2FProjects%2FNSS%2FReference%2FNSPR_functions%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fmozilla%2Fprojects%2Fnss%2Freference%2Fnspr_functions%2Findex.html%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2Fe7adae4c255ddbe6412a546794d12f746104b299%0A*+Document+last+modified%3A+2021-03-24T11%3A41%3A35.000Z%0A%0A%3C%2Fdetails%3E&amp;title=Issue+with+%22NSPR+functions%22%3A+%28short+summary+here+please%29&amp;labels=Content%3AOther%2Cneeds-triage" title="This will take you to https://github.com/mdn/content to file a new issue" target="_blank" rel="noopener noreferrer">Report a problem with this content on <b>GitHub</b></a></li><li>Want to fix the problem yourself? See<!-- --> <a href="https://github.com/mdn/content/blob/main/README.md" target="_blank" rel="noopener noreferrer">our Contribution guide</a>.</li></ul></div><p class="last-modified-date"><b>Last modified:</b> <time datetime="2021-03-24T11:41:35.000Z">Mar 24, 2021</time>,<!-- --> <a href="/en-US/docs/Mozilla/Projects/NSS/Reference/NSPR_functions/contributors.txt">by MDN contributors</a></p></div></aside></main></body></html>