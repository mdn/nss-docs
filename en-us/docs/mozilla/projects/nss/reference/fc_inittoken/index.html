<!DOCTYPE html><html><head><meta charset="utf-8"><title>FC_InitToken - Mozilla | MDN</title></head><body><main><article class="main-page-content" lang="en-US"><h1>FC_InitToken</h1><h3 id="name"><a href="#name" title="Permalink to  Name "> Name </a></h3><div><p><code>FC_InitToken()</code> - initialize or re-initialize a token.
</p></div><h3 id="syntax"><a href="#syntax" title="Permalink to  Syntax "> Syntax </a></h3><div><pre class="eval notranslate"><a href="/en-US/CK_RV" data-flaw="link1">CK_RV</a> FC_InitToken(
  <a href="/en-US/CK_SLOT_ID" data-flaw="link2">CK_SLOT_ID</a> slotID,
  <a href="/en-US/CK_CHAR" data-flaw="link3">CK_CHAR_PTR</a> pPin,
  <a href="/en-US/CK_ULONG" data-flaw="link4">CK_ULONG</a> ulPinLen,
  <a href="/en-US/CK_CHAR" data-flaw="link5">CK_CHAR_PTR</a> pLabel
);
</pre></div><h3 id="parameters"><a href="#parameters" title="Permalink to  Parameters "> Parameters </a></h3><div><p><code>FC_InitToken()</code> has the following parameters:
</p>
<dl><dt><code>slotID</code></dt><dd> the ID of the token's slot
</dd><dt><code>pPin</code></dt><dd> the password of the security officer (SO)
</dd><dt><code>ulPinLen</code></dt><dd> the length in bytes of the SO password
</dd><dt><code>pLabel</code></dt><dd> points to the label of the token, which must be padded with spaces to 32 bytes and not be null-terminated
</dd></dl></div><h3 id="description"><a href="#description" title="Permalink to  Description "> Description </a></h3><div><p><code>FC_InitToken()</code> initializes a brand new token or re-initializes a token that was initialized before.
</p><p>Specifically, <code>FC_InitToken()</code> initializes or clears the key database, removes the password, and then marks all the <i>user certs</i> in the certificate database as <i>non-user certs</i>. (User certs are the certificates that have their associated private keys in the key database.)
</p><p>A user must be able to call <code>FC_InitToken()</code> without logging into the token (to assume the NSS User role) because either the user's password hasn't been set yet or the user forgets the password and needs to blow away the password-encrypted private key database and start over.
</p>
<div class="note notecard">
<p><b>Note:</b> The SO password should be the empty string, i.e., <code>ulPinLen</code> argument should be 0. <code>FC_InitToken()</code> ignores the <code>pLabel</code> argument.
</p>
</div></div><h3 id="return_value"><a href="#return_value" title="Permalink to  Return value "> Return value </a></h3><div><p><code>FC_InitToken()</code> returns the following return codes.
</p>
<ul><li> <code>CKR_OK</code>: token initialization succeeded.
</li><li> <code>CKR_SLOT_ID_INVALID</code>: slot ID is invalid.
</li><li> <code>CKR_TOKEN_WRITE_PROTECTED</code>
<ul><li> we don't have a reference to the key database (we failed to open the key database or we have released our reference).
</li></ul>
</li><li> <code>CKR_DEVICE_ERROR</code>: failed to reset the key database.
</li></ul></div><h3 id="application_usage"><a href="#application_usage" title="Permalink to  Application usage "> Application usage </a></h3><div><p><code>FC_InitToken()</code> is used to reset the password for the key database when the user forgets the password.
</p>
<ul><li> The "Reset Password" button of the Mozilla Application Suite and SeaMonkey (in Preferences-&gt;Privacy &amp; Security-&gt;Master Passwords) calls <code>FC_InitToken()</code>.
</li><li> The "-T" (token reset) command of <code>certutil</code> calls <code>FC_InitToken()</code>.
</li></ul>
<div class="note notecard"><b>Note:</b> Resetting the password clears all permanent secret and private keys. You won't be able to decrypt the data, such as Mozilla's stored passwords, that were encrypted using any of those keys.</div></div><h3 id="see_also"><a href="#see_also" title="Permalink to  See also "> See also </a></h3><div><ul><li> <a href="/en-US/docs/Mozilla/Projects/NSS/Reference/FC_InitPIN">FC_InitPIN</a>, <a href="/en-US/NSC_InitToken" data-flaw="link6">NSC_InitToken</a>
</li></ul></div></article><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h4>Found a problem with this page?</h4><ul><li><a href="https://github.com/mdn/content/blob/main/files/en-us/mozilla/projects/nss/reference/fc_inittoken/index.html" title="Folder: en-us/mozilla/projects/nss/reference/fc_inittoken (Opens in a new tab)" target="_blank" rel="noopener noreferrer">Source on <b>GitHub</b></a></li><li><a href="https://github.com/mdn/content/issues/new?body=MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FMozilla%2FProjects%2FNSS%2FReference%2FFC_InitToken%0A%0A%23%23%23%23+What+information+was+incorrect%2C+unhelpful%2C+or+incomplete%3F%0A%0A%0A%23%23%23%23+Specific+section+or+headline%3F%0A%0A%0A%23%23%23%23+What+did+you+expect+to+see%3F%0A%0A%0A%23%23%23%23+Did+you+test+this%3F+If+so%2C+how%3F%0A%0A%0A%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EMDN+Content+page+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fmozilla%2Fprojects%2Fnss%2Freference%2Ffc_inittoken%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FMozilla%2FProjects%2FNSS%2FReference%2FFC_InitToken%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fmozilla%2Fprojects%2Fnss%2Freference%2Ffc_inittoken%2Findex.html%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2F7d7b3ff1ba04dbcf036be287d95f3b8820a6fe94%0A*+Document+last+modified%3A+2021-03-15T09%3A52%3A33.000Z%0A%0A%3C%2Fdetails%3E&amp;title=Issue+with+%22FC_InitToken%22%3A+%28short+summary+here+please%29&amp;labels=Content%3AOther%2Cneeds-triage" title="This will take you to https://github.com/mdn/content to file a new issue" target="_blank" rel="noopener noreferrer">Report a problem with this content on <b>GitHub</b></a></li><li>Want to fix the problem yourself? See<!-- --> <a href="https://github.com/mdn/content/blob/main/README.md" target="_blank" rel="noopener noreferrer">our Contribution guide</a>.</li></ul></div><p class="last-modified-date"><b>Last modified:</b> <time datetime="2021-03-15T09:52:33.000Z">Mar 15, 2021</time>,<!-- --> <a href="/en-US/docs/Mozilla/Projects/NSS/Reference/FC_InitToken/contributors.txt">by MDN contributors</a></p></div></aside></main></body></html>