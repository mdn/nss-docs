<!DOCTYPE html><html><head><meta charset="utf-8"><title>NSS Certificate Download Specification - Mozilla | MDN</title></head><body><main><article class="main-page-content" lang="en-US"><h1>NSS Certificate Download Specification</h1><div><p>This document describes the data formats used by NSS 3.x for installing certificates. This document is currently being revised and has not yet been reviewed for accuracy.</p></div><h2 id="data_formats"><a href="#data_formats" title="Permalink to Data Formats">Data Formats</a></h2><div><p>NSS can accept certificates in several formats. In all cases the certificates are X509 version 1, 2, or 3.</p></div><h3 id="binary_formats"><a href="#binary_formats" title="Permalink to Binary Formats">Binary Formats</a></h3><div><p>NSS's certificate loader will recognize several binary formats. They are:</p>

<ul>
 <li><strong>DER encoded certificate:</strong> This is a single binary DER encoded certificate.</li>
 <li><strong>PKCS#7 certificate chain:</strong> This is a single <a class="link-ftp" href="ftp://ftp.rfc-editor.org/in-notes/rfc2315.txt">PKCS#7</a> <code>SignedData</code> object. The only significant field in the <code>SignedData</code> object is the <code>certificates</code> field, which may contain multiple certificates to be imported together. The contents of the <code>version</code>, <code>digestAlgorithms</code>, <code>contentInfo</code>, <code>crls</code>, and <code>signerInfos</code> fields are ignored.</li>
 <li><strong>Netscape Certificate Sequence:</strong> This is another <a class="link-ftp" href="ftp://ftp.rfc-editor.org/in-notes/rfc2315.txt">PKCS#7</a> object format, and like the <code>SignedData</code> format, it allows multiple certificates to be imported together. This format is simpler than the <a class="link-ftp" href="ftp://ftp.rfc-editor.org/in-notes/rfc2315.txt">PKCS#7</a> <code>SignedData</code> object format. It consists of a <a class="link-ftp" href="ftp://ftp.rfc-editor.org/in-notes/rfc2315.txt">PKCS#7</a> <code>ContentInfo</code> structure, wrapping a sequence of certificates. The <code>contentType</code> field OID must be <code>netscape-cert-sequence</code> (see <a href="/en-US/docs/Mozilla/Projects/NSS/Certificate_Download_Specification#object_identifiers">Object Identifiers</a>). The <code>content</code> field is the following ASN.1 structure:</li>
</ul>

<pre class="eval notranslate">   CertificateSequence&nbsp;::= SEQUENCE OF Certificate
</pre>

<p>See the section below on <a href="/en-US/docs/Mozilla/Projects/NSS/Certificate_Download_Specification#importing_certificate_chains">Certificate Chains</a> for more information about how multiple certificates are handled.</p></div><h3 id="text_formats"><a href="#text_formats" title="Permalink to Text Formats">Text Formats</a></h3><div><p>Any of the above <a href="/en-US/docs/Mozilla/Projects/NSS/Certificate_Download_Specification#binary_formats">binary formats</a> can also be imported in text form. The text form begins with the following line:</p>

<pre class="eval notranslate">   -----BEGIN CERTIFICATE-----
</pre>

<p>Following this line should be the certificate data, which can be in any of the <a href="/en-US/docs/Mozilla/Projects/NSS/Certificate_Download_Specification#binary_formats">binary formats</a> described above. This data must be base64 encoded as described by <a class="external" href="https://datatracker.ietf.org/doc/html/rfc1113" rel=" noopener">RFC 1113</a>. Following the data should be the following line:</p>

<pre class="eval notranslate">   -----END CERTIFICATE-----
</pre>

<p>In a text format download, NSS ignores any text before the first <code>BEGIN CERTIFICATE</code> line, and ignores any text after the first <code>END CERTIFICATE</code> line. Between those two lines, there must be exactly ONE item of any of the supported binary formats described above, and that one item must be base64 encoded. Regardless of which of the supported binary formats is used, the <code>BEGIN</code> and <code>END</code> lines must say <code>CERTIFICATE</code>, and not any other word (such as <code>KEY</code>). The <code>BEGIN</code> and <code>END</code> lines must begin and end with 5 dashes, with no extra leading or trailing white space (excluding the End Of Line characters).</p></div><h2 id="importing_certificate_chains"><a href="#importing_certificate_chains" title="Permalink to Importing Certificate Chains">Importing Certificate Chains</a></h2><div><p>Several of the formats described above can contain several certificates. When NSS's certificate decoder encounters one of these collections of multiple certificates they are handled in the following way:</p>

<ul>
 <li>The first certificate is processed in a context specific manner, depending upon how it is being imported. For Mozilla browsers, this handling will depend upon the mime <code>Content-Type</code> that is used on the object being downloaded. For NSS-based servers it will depend upon the options selected in the server's administration interface.</li>
</ul>

<ul>
 <li>Subsequent certificates are all treated the same. If the certificates contain a <code>BasicConstraints</code> certificate extension that indicates they are CA certificates, and do not already exist in the local certificate database, they are added as untrusted CAs. In this way they may be used for certificate chain validation, as long as there is a trusted CA somewhere along the chain.</li>
</ul></div><h3 id="importing_certificates_into_mozilla_browsers"><a href="#importing_certificates_into_mozilla_browsers" title="Permalink to Importing Certificates into Mozilla browsers">Importing Certificates into Mozilla browsers</a></h3><div><p>Mozilla browsers import certificates found in HTTP protocol responses. There are several mime content types that are used to indicate to the browser what type of certificate is being imported. These mime types are:</p>

<ul>
 <li><strong><code>application/x-x509-user-cert</code></strong> The certificate being downloaded is a user certificate belonging to the user operating the browser. If the private key associated with the certificate does not exist in the user's local key database, then an error dialog is generated and the certificate is not imported. If a certificate chain is being imported then the first certificate in the chain must be the user certificate, and any subsequent certificates will be added as untrusted CA certificates to the local database.</li>
 <li><strong><code>application/x-x509-ca-cert</code></strong> The certificate being downloaded represents a Certificate Authority. When it is downloaded the user will be shown a sequence of dialogs that will guide them through the process of accepting the Certificate Authority and deciding if they wish to trust sites certified by the CA. If a certificate chain is being imported then the first certificate in the chain must be the CA certificate, and any subsequent certificates will be added as untrusted CA certificates to the local database.</li>
 <li><strong><code>application/x-x509-email-cert</code></strong> The certificate being downloaded is a user certificate belonging to another user for use with S/MIME. If a certificate chain is being imported then the first certificate in the chain must be the user certificate, and any subsequent certificates will be added as untrusted CA certificates to the local database. This is intended to allow people or CAs to post their e-mail certificates on web pages for download by other users who want to send them encrypted mail.</li>
</ul>

<p>Note: the browser checks that the size of the object being downloaded matches the size of the encoded certificates. Therefore it is important to ensure that no extra characters, such as NULLs or LineFeeds are added at the end of the object.</p></div><h3 id="importing_certificates_into_nss-based_servers"><a href="#importing_certificates_into_nss-based_servers" title="Permalink to Importing Certificates into NSS-based servers">Importing Certificates into NSS-based servers</a></h3><div><p>Consult your server's administration guide for the most accurate information. For some NSS-base servers, the following information is correct.</p>

<p>Server certificates are imported via the server admin interface. Certificates are pasted into a text input field in an HTML form, and then the form is submitted to the admin server. Since the certificates are pasted into text fields, only the <a href="/en-US/docs/Mozilla/Projects/NSS/Certificate_Download_Specification#text_formats">text formats</a> described above are supported for servers. The type of certificate being imported (e.g. server or CA or cert chain) is specified by the server administrator by selections made on the admin pages. If a certificate chain is being imported then the first certificate in the chain must be the server or CA certificate, and any subsequent certificates will be added as untrusted CA certificates to the local database.</p></div><h2 id="object_identifiers"><a href="#object_identifiers" title="Permalink to Object Identifiers">Object Identifiers</a></h2><div><p>The base of all Netscape object ids is:</p>

<pre class="eval notranslate">   netscape OBJECT IDENTIFIER&nbsp;::= { 2 16 840 1 113730 }
</pre>

<p>The hexadecimal byte value of this OID when DER encoded is:</p>

<pre class="eval notranslate">   0x60, 0x86, 0x48, 0x01, 0x86, 0xf8, 0x42
</pre>

<p>The following OIDs are mentioned in this document:</p>

<pre class="eval notranslate">   netscape-data-type     OBJECT IDENTIFIER&nbsp;:: = { netscape 2 }
   netscape-cert-sequence OBJECT IDENTIFIER&nbsp;:: = { netscape-data-type 5 }
</pre></div></article><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h4>Found a problem with this page?</h4><ul><li><a href="https://github.com/mdn/content/blob/main/files/en-us/mozilla/projects/nss/certificate_download_specification/index.html" title="Folder: en-us/mozilla/projects/nss/certificate_download_specification (Opens in a new tab)" target="_blank" rel="noopener noreferrer">Source on <b>GitHub</b></a></li><li><a href="https://github.com/mdn/content/issues/new?body=MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FMozilla%2FProjects%2FNSS%2FCertificate_Download_Specification%0A%0A%23%23%23%23+What+information+was+incorrect%2C+unhelpful%2C+or+incomplete%3F%0A%0A%0A%23%23%23%23+Specific+section+or+headline%3F%0A%0A%0A%23%23%23%23+What+did+you+expect+to+see%3F%0A%0A%0A%23%23%23%23+Did+you+test+this%3F+If+so%2C+how%3F%0A%0A%0A%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EMDN+Content+page+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fmozilla%2Fprojects%2Fnss%2Fcertificate_download_specification%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FMozilla%2FProjects%2FNSS%2FCertificate_Download_Specification%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fmozilla%2Fprojects%2Fnss%2Fcertificate_download_specification%2Findex.html%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2F48fca0c614add538e95f1075b2777fc396023d31%0A*+Document+last+modified%3A+2021-03-16T07%3A50%3A01.000Z%0A%0A%3C%2Fdetails%3E&amp;title=Issue+with+%22NSS+Certificate+Download+Specification%22%3A+%28short+summary+here+please%29&amp;labels=Content%3AOther%2Cneeds-triage" title="This will take you to https://github.com/mdn/content to file a new issue" target="_blank" rel="noopener noreferrer">Report a problem with this content on <b>GitHub</b></a></li><li>Want to fix the problem yourself? See<!-- --> <a href="https://github.com/mdn/content/blob/main/README.md" target="_blank" rel="noopener noreferrer">our Contribution guide</a>.</li></ul></div><p class="last-modified-date"><b>Last modified:</b> <time datetime="2021-03-16T07:50:01.000Z">Mar 16, 2021</time>,<!-- --> <a href="/en-US/docs/Mozilla/Projects/NSS/Certificate_Download_Specification/contributors.txt">by MDN contributors</a></p></div></aside></main></body></html>